<%= simple_form_for [:dashboard, @post] do |f| %>
  <%= f.error_notification %>
  <%= f.input :title, autofocus: true %>
  
  <% if lookup_context.template_exists?("storytime/dashboard/posts/_#{@post.type_name}_fields") %>
    <%= render("storytime/dashboard/posts/#{@post.type_name}_fields", f: f)  %>
  <% end %>
  
  <%= f.input :excerpt %>
  <%= f.input :draft_content, as: :text, input_html: { rows: 20, class: "wysiwyg" }, label: "Content" %>
  
  <%= f.input :featured_media_id, as: :hidden, input_html: { id: "featured_media_id" } %>
  <%= link_to "Select Featured Image", "#", class: "btn btn-default", id: "featured_media_button" %>
  <div id="featured_media_container">
    <%= image_tag @post.featured_media.file_url(:thumb), id: "featured_media_image" if @post.featured_media %>
  </div>

  <%= f.input :tag_list %>
  
  <%= f.input :published, as: :boolean, label: false, inline_label: true if Pundit.policy(current_user, @post).publish? %>
  
  <div class="actions">
    <%= f.submit (@post.new_record? ? "Create #{@post.type_name.humanize}" : "Update #{@post.type_name.humanize}"), class: "btn btn-primary" %>
  </div>
<% end %>

<%= render "storytime/dashboard/media/modal" %>