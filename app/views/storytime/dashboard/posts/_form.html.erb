<%= simple_form_for [:dashboard, @post] do |f| %>
  <%= f.error_notification %>
  <%= f.input :title, autofocus: true %>
  
  <%= f.fields_for :custom_field_responses do |builder| %>
    <%= builder.input :custom_field_id, as: :hidden %>
    <%= render "storytime/dashboard/custom_fields/#{builder.object.custom_field.partial_name}", f: builder %>
  <% end %>
  
  <% if lookup_context.template_exists?("storytime/dashboard/posts/_#{current_post_type.name.underscore}_fields") %>
    <%= render("storytime/dashboard/posts/#{current_post_type.name.underscore}_fields", f: f)  %>
  <% end %>

  <%= f.input :post_type_id, as: :hidden %>
  <%= f.input :excerpt %>
  <%= f.input :draft_content, as: :text, input_html: { rows: 20, class: "wysiwyg" }, label: "Content" %>
  
  <%= f.input :featured_media_id, as: :hidden, input_html: { id: "featured_media_id" } %>
  <%= link_to "Select Featured Image", "#", class: "btn btn-default", id: "featured_media_button" %>
  <div id="featured_media_container">
    <%= image_tag @post.featured_media.file_url(:thumb), id: "featured_media_image" if @post.featured_media %>
  </div>

  <%= f.input :tag_list %>
  
  <%= f.input :published, as: :boolean, label: false, inline_label: true if Pundit.policy(current_user, @post).publish? %>
  
  <div class="actions">
    <%= f.submit (@post.new_record? ? "Create #{current_post_type.name.humanize}" : "Update #{current_post_type.name.humanize}"), class: "btn btn-primary" %>
  </div>
<% end %>

<%= render "storytime/dashboard/media/modal" %>